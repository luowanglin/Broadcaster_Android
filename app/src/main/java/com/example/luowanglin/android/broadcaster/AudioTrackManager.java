package com.example.luowanglin.android.broadcaster;import android.media.AudioFormat;import android.media.AudioManager;import android.media.AudioTrack;/** * Created by luowanglin on 2017/4/9. */class AudioTrackManager {    public static final int RATE=44100;    public static final float MAXVOLUME=100f;    public static final int LEFT=1;    public static final int RIGHT=2;    public static final int DOUBLE=3;    AudioTrack audioTrack;    /** **/    float volume;    /** **/    int channel;    /** **/    int length;    /** **/    int waveLen;    /** **/    int Hz;    /** **/    byte[] wave;    public AudioTrackManager(){        wave=new byte[RATE];    }    /**     *     * @param rate     */    public void start(int rate){        if(rate>0){            Hz=rate;            waveLen = 44100/ Hz;            length = waveLen * Hz;            audioTrack=new AudioTrack(AudioManager.STREAM_MUSIC, 44100,                    AudioFormat.CHANNEL_CONFIGURATION_MONO, // CHANNEL_CONFIGURATION_MONO,                    AudioFormat.ENCODING_PCM_8BIT,length,AudioTrack.MODE_STREAM);            //生成正弦波            wave=Wave.sin(wave, waveLen, length);//            if(audioTrack!=null){//                audioTrack.play();//            }        }else{            return;        }    }    /**     *     */    public void play(){        if(audioTrack!=null){            audioTrack.play();            audioTrack.write(wave, 0, length);        }    }    /**     *     */    public void stop(){        if(audioTrack!=null){            audioTrack.stop();            audioTrack.release();            audioTrack=null;        }    }    /**     *     * @param volume     */    public void setVolume(float volume){        this.volume=volume;        if(audioTrack!=null){            switch (channel) {                case LEFT:                    audioTrack.setStereoVolume(volume/MAXVOLUME, 0f);                    break;                case RIGHT:                    audioTrack.setStereoVolume(0f, volume/MAXVOLUME);                    break;                case DOUBLE:                    audioTrack.setStereoVolume(volume/MAXVOLUME, volume/MAXVOLUME);                    break;            }        }    }    /**     *     * @param channel     */    public void setChannel(int channel){        this.channel=channel;        setVolume(volume);    }}